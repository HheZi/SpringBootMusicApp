<div class="container mt-4">
  <div class="author-header d-flex align-items-center mb-4" *ngIf="!isNotFound; else NotFound">
    <img [src]="author.imageUrl" alt="Author Image" class="author-image me-3" />
    <div>
      <h1>{{ author.name }} <i *ngIf="canModify" class="pi pi-pencil icon btn-sm" (click)="openOrCloseDialog()"></i></h1>
      
    </div>
  </div>

  <ng-template #NotFound>
    <h1 class="text-center">Author Is not Found</h1>
  </ng-template>

  <div class="albums-section mt-5">
    <h3>Albums</h3>
    <div *ngIf="albums.length > 0; else noAlbum">
      <div *ngFor="let album of albums" class="album-item d-flex align-items-center p-1 mb-2 border-bottom"
        (click)="seeAlbum(album.id)">
        <img [src]="album.imageUrl" alt="Album Cover" class="img img-thumbnail " />
        <div class="flex-grow-1">
          <h5 class="mb-1">{{ album.name }}</h5>
        </div>
      </div>
    </div>
    <ng-template #noAlbum>
      <p>No albums found for this author.</p>
    </ng-template>
  </div>

  <div class="tracks-section mt-5">
    <h3>Tracks</h3>
    <div *ngIf="tracks.length > 0; else noTracks" class="mt-3 mb-3">
      <div class="container" *ngFor="let track of tracks; let i = index">
        <div class="container border-bottom d-flex align-items-center track-container" (dblclick)="playTrack(i)">
          <img src="{{track.imageUrl}}" alt="Image" class="img img-thumbnail">
          <div class="ms-5 me-5 container-fluid">
            <h5 class="track-title mb-1">{{ track.title }}</h5>
          </div>
          <div class="flex-grow-1 d-flex justify-content-center align-items-center track-info-container">
            <span class="album-name text-center">
              <a (click)="seeAlbum(track.albumId)" class="link">{{ track.albumName }}</a>
            </span>
          </div>
          <div class="d-flex align-items-center track-duration-container">
            <span class="track-duration text-muted me-2">{{ track.duration }}</span>
            <span *ngIf="track.isNowPlaying" class="now-playing-icon ms-2">
              <i class="pi pi-play-circle"></i>
            </span>
          </div>
        </div>
      </div>
    </div>
    <ng-template #noTracks>
      <p>No tracks found for this author.</p>
    </ng-template>
  </div>

  <p-dialog [(visible)]="updateDialog" [header]="'Edit Author'" [modal]="true" [closable]="true" [style]="{width: '500px'}">
        
    <div class="form-group mt-2">
        <input type="text" id="albumName" class="form-control" [(ngModel)]="editableAuthor.name" placeholder="Name"/>
    </div>

    <div class="form-group">
        <label for="albumCover">Image</label>
        <input type="file" id="albumCover" class="form-control" (change)="onFileChange($event)"/>
        <img *ngIf="previewImage" [src]="previewImage" alt="Cover Preview" class="img-thumbnail mt-2" style="max-width: 250px;"/>
    </div>
    
    <ng-template pTemplate="footer">
        <button type="button" class="btn btn-secondary me-2" (click)="updateDialog = false">Cancel</button>
        <button type="button" class="btn btn-primary" (click)="editAuthor()">Save</button>
    </ng-template>
</p-dialog>
</div>